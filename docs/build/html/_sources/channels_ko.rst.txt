=======================
콘다 채널 관리
=======================

여러개의 채널이 동일한 패키지를 갖는 것이 가능하기 때문에 콘다는 반드시 여러개의 채널이 충돌하지 않게끔 관리해야 한다.
디폴트 채널만을 사용하거나 다른 채널과 중복되지 않는 패키지만 포함하는 채널을 사용할 경우 채널간의 충돌은 없다.
콘다가 채널간의 충돌을 해결하는 방법은 여러개의 채널을 동일한 패키지를 호스팅하는 채널 리스트에 가지고 있을 때만 유효하다.

콘다 4.1.0 이전
==================

2016년 6월 14일에 배포된 4.1.0 버전 이전의 콘다는 두개의 채널이 동일한 이름의 패키지를 호스팅할 때
버전 번호가 가장 높은 패키지를 설치했다. 두 패키지가 동일한 버전 번호를 갖는다면 콘다는 빌드 번호가 높은 쪽을 설치했다.
버전 번호와 빌드 번호가 동일할 때만 채널의 순서가 설치될 채널을 결정했다. 이 방식은 세가지 문제가 있다.

1. *다른 채널의 빌드 번호와 비교할 수 없다.* 채널 A 는 일간으로 빌드되고 채널 B 는 주간으로 빌드 되었다고 하자.
이 때 채널 B 의 빌드 2는 채널 A 의 빌드 4 보다 최신 버전이다.

2. *사용자가 선호하는 채널을 지정할 수 없다.* 채널 A 보다 채널 B 를 신뢰해 채널 B 의 패키지가 더
   오래된 버전일지라도 채널 B 를 통해 패키지를 받고자 할 수 있다.
   4.1.0 버전 이전에는 선호하는 채널을 고를 방법이 없었다. 오로지 버전과 빌드 번호에 따라 패키지가 설치 된다.

3. *빌드 번호 충동.* 이 문제는 앞서 다룬 두 문제로 인해 발생한다.
   채널 A 로부터 패키지 알파, 채널 B 로부터 패키지 베타를 사용하고 있다고 하자.
   채널 B 의 공급자가 알파 버전의 패키지를 아주 높은 빌드 번호로 채널 B 에 추가하면
   사용자가 원치 않더라도 채널 B 로부터 알파를 설치한다.
   이 경우에 의도치 않은 문제와 고의적인 공격의 위험이 있다.

콘다 4.1.0 이후
=================

이제 콘다는 우선 순위가 높은 채널의 패키지를 선호하는 것이 디폴트이다.
따라서 채널을 채널 목록 하단에 두면 디폴트 채널에 없는 패키지를 안전하게 다운로드할 수 있다.
채널 목록 하단에 있는 채널은 핵심 패키지셋을 건드리지 않는다.

디폴트에 의해 콘다는 채널 목록의 모든 채널로부터 동일한 명칭의 패키지를 모두 가져오고
이를 채널 우선순위가 높은 순서로 분류한다. 분류된 채널을 버전 번호, 빌드 번호에 따라 다시 분류하고
설치 사양을 만족하는 첫번째 패키지를 설치한다.

콘다가 이전 방식대로 채널 목록으로부터 가장 최신 버전의 패키지를 설치하게 하려면 .condarc 파일에
``channel_priority: false`` 를 추가한다. (``conda config --set channel_priority false``
커맨드를 사용하는 것과 동일하다.) 이제 콘다는 패키지 목록을 버전 번호가 높은 순서로 분류한다.
분류된 채널들을 채널 우선순위, 빌드 번호에 따라 다시 분류한다.
다른 채널로부터 가져온 빌드 번호는 비교가 불가능하므로 채널 우선순위 다음으로 빌드번호를 분류한다.

``conda config --add channels new_channel`` 커맨드는 채널 리스트 상단에 새로운 채널을 추가해
높은 우선수위를 부여한다. ``conda config --prepend channels new_channel`` 커맨드와 동일하다.
``conda config --append channels new_channel`` 커맨드는 채널 리스트 하단에 새로운 채널을 추가해
낮은 우선순위를 부여한다.
